### LazySpender Transaction API Tests
### Using REST Client extension by Huachao Mao

@baseUrl = http://localhost:8080
@apiPath = /api/transactions

### Variables for testing
@transactionId = 1
@owner = testuser

###############################################
# CREATE Transaction
###############################################

### Create a new transaction (Expense)
POST {{baseUrl}}{{apiPath}}
Content-Type: application/json

{
  "owner": "john_doe",
  "account": "Credit Card",
  "category": "Food & Dining",
  "amount": -25.50,
  "note": "Lunch at restaurant",
  "date": "2025-12-05T12:30:00Z",
  "currency": "USD",
  "refCurrencyAmount": -25.50
}

### Create a new transaction (Income)
POST {{baseUrl}}{{apiPath}}
Content-Type: application/json

{
  "owner": "john_doe",
  "account": "Savings Account",
  "category": "Salary",
  "amount": 3500.00,
  "note": "Monthly salary",
  "date": "2025-12-01T09:00:00Z",
  "currency": "USD",
  "refCurrencyAmount": 3500.00
}

### Create transaction with different currency
POST {{baseUrl}}{{apiPath}}
Content-Type: application/json

{
  "owner": "jane_doe",
  "account": "Cash",
  "category": "Shopping",
  "amount": -50.00,
  "note": "Shopping in Europe",
  "date": "2025-12-05T15:45:00Z",
  "currency": "EUR",
  "refCurrencyAmount": -54.50
}

### Create transaction - Minimal data
POST {{baseUrl}}{{apiPath}}
Content-Type: application/json

{
  "owner": "john_doe",
  "account": "Debit Card",
  "category": "Transport",
  "amount": -15.00,
  "date": "2025-12-05T08:00:00Z",
  "currency": "USD",
  "refCurrencyAmount": -15.00
}

###############################################
# GET Transaction by ID
###############################################

### Get transaction by ID
GET {{baseUrl}}{{apiPath}}/{{transactionId}}

### Get transaction by ID (not found test)
GET {{baseUrl}}{{apiPath}}/99999

###############################################
# GET All Transactions (Paginated)
###############################################

### Get all transactions (default pagination)
GET {{baseUrl}}{{apiPath}}

### Get all transactions (page 0, size 10)
GET {{baseUrl}}{{apiPath}}?page=0&size=10

### Get all transactions (page 1, size 5)
GET {{baseUrl}}{{apiPath}}?page=1&size=5

### Get all transactions (large page size)
GET {{baseUrl}}{{apiPath}}?page=0&size=50

###############################################
# GET Transactions by Owner (Paginated)
###############################################

### Get transactions by owner (default pagination)
GET {{baseUrl}}{{apiPath}}/owner/{{owner}}

### Get transactions by owner (page 0, size 10)
GET {{baseUrl}}{{apiPath}}/owner/john_doe?page=0&size=10

### Get transactions by owner (page 1, size 5)
GET {{baseUrl}}{{apiPath}}/owner/jane_doe?page=1&size=5

### Get transactions by non-existent owner
GET {{baseUrl}}{{apiPath}}/owner/nonexistent_user

###############################################
# UPDATE Transaction
###############################################

### Update transaction
PUT {{baseUrl}}{{apiPath}}/{{transactionId}}
Content-Type: application/json

{
  "owner": "john_doe",
  "account": "Credit Card",
  "category": "Food & Dining",
  "amount": -30.00,
  "note": "Updated lunch expense",
  "date": "2025-12-05T12:30:00Z",
  "currency": "USD",
  "refCurrencyAmount": -30.00
}

### Update transaction - Change category and amount
PUT {{baseUrl}}{{apiPath}}/2
Content-Type: application/json

{
  "owner": "john_doe",
  "account": "Savings Account",
  "category": "Bonus",
  "amount": 4000.00,
  "note": "Updated to include bonus",
  "date": "2025-12-01T09:00:00Z",
  "currency": "USD",
  "refCurrencyAmount": 4000.00
}

### Update non-existent transaction
PUT {{baseUrl}}{{apiPath}}/99999
Content-Type: application/json

{
  "owner": "john_doe",
  "account": "Credit Card",
  "category": "Food",
  "amount": -10.00,
  "note": "Test",
  "date": "2025-12-05T12:00:00Z",
  "currency": "USD",
  "refCurrencyAmount": -10.00
}

###############################################
# DELETE Transaction
###############################################

### Delete transaction
DELETE {{baseUrl}}{{apiPath}}/{{transactionId}}

### Delete transaction by specific ID
DELETE {{baseUrl}}{{apiPath}}/3

### Delete non-existent transaction
DELETE {{baseUrl}}{{apiPath}}/99999

###############################################
# VALIDATION TESTS (Should return 400 errors)
###############################################

### Create transaction - Missing required field (owner)
POST {{baseUrl}}{{apiPath}}
Content-Type: application/json

{
  "account": "Credit Card",
  "category": "Food",
  "amount": -25.50,
  "note": "Missing owner",
  "date": "2025-12-05T12:00:00Z",
  "currency": "USD",
  "refCurrencyAmount": -25.50
}

### Create transaction - Missing required field (amount)
POST {{baseUrl}}{{apiPath}}
Content-Type: application/json

{
  "owner": "john_doe",
  "account": "Credit Card",
  "category": "Food",
  "note": "Missing amount",
  "date": "2025-12-05T12:00:00Z",
  "currency": "USD",
  "refCurrencyAmount": -25.50
}

### Create transaction - Missing required field (date)
POST {{baseUrl}}{{apiPath}}
Content-Type: application/json

{
  "owner": "john_doe",
  "account": "Credit Card",
  "category": "Food",
  "amount": -25.50,
  "note": "Missing date",
  "currency": "USD",
  "refCurrencyAmount": -25.50
}

### Create transaction - Empty string for required field
POST {{baseUrl}}{{apiPath}}
Content-Type: application/json

{
  "owner": "",
  "account": "Credit Card",
  "category": "Food",
  "amount": -25.50,
  "note": "Empty owner",
  "date": "2025-12-05T12:00:00Z",
  "currency": "USD",
  "refCurrencyAmount": -25.50
}

### Create transaction - Invalid JSON
POST {{baseUrl}}{{apiPath}}
Content-Type: application/json

{
  "owner": "john_doe",
  "account": "Credit Card",
  "category": "Food",
  "amount": -25.50,
  "note": "Invalid JSON",
  "date": "2025-12-05T12:00:00Z",
  "currency": "USD",
  "refCurrencyAmount": -25.50
}
